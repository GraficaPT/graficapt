<!DOCTYPE html>
<html lang="pt">
<head>
  <meta charset="UTF-8">
  <title>Upload para o Google Drive</title>
</head>
<body>
  <h2>Enviar ficheiro</h2>

  <input type="file" id="ficheiro" required>
  <button onclick="enviar()">Enviar</button>

  <p id="resposta"></p>

  <script>
    async function enviar() {
      const ficheiro = document.getElementById("ficheiro").files[0];
      if (!ficheiro) {
        alert("Seleciona um ficheiro.");
        return;
      }

      const reader = new FileReader();
      reader.onload = async function () {
        const base64 = reader.result.split(',')[1];

        const formData = new FormData();
        formData.append("base64", base64);
        formData.append("type", ficheiro.type);
        formData.append("name", ficheiro.name);

        const resposta = await fetch("https://script.google.com/macros/s/AKfycbwALvmtB1RzY3xKAlECemjWh91PxyDoARXiI9CU-7fdGezjuo25G2kX12yQuwZc-pJ-7A/exec", {
          method: "POST",
          body: formData
        });

        const texto = await resposta.text();
        document.getElementById("resposta").innerHTML = texto.startsWith("http")
          ? `✅ <a href="${texto}" target="_blank">Ficheiro carregado</a>`
          : `❌ ${texto}`;
      };

      reader.readAsDataURL(ficheiro);
    }
  </script>
</body>
</html>
